
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard  2024 vs 2025</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
    <!-- AnyChart Libraries -->
    <script src="https://cdn.anychart.com/releases/v8/js/anychart-base.min.js"></script>
    <script src="https://cdn.anychart.com/releases/v8/js/anychart-ui.min.js"></script>
    <script src="https://cdn.anychart.com/releases/v8/js/anychart-exports.min.js"></script>
    <link href="https://cdn.anychart.com/releases/v8/css/anychart-ui.min.css" type="text/css" rel="stylesheet">
    <link href="https://cdn.anychart.com/releases/v8/fonts/css/anychart-font.min.css" type="text/css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #95a5a6 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .header h1 {
            font-size: 2.8em;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.95;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
            border-radius: 15px;
            padding: 25px;
            color: white;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .kpi-card:nth-child(2) {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        }

        .kpi-card:nth-child(3) {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }

        .kpi-card:nth-child(4) {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
        }

        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .kpi-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .kpi-title {
            font-size: 0.95em;
            opacity: 0.9;
            margin-bottom: 10px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .kpi-value {
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .kpi-comparison {
            font-size: 0.9em;
            opacity: 0.95;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .kpi-badge {
            background: rgba(255, 255, 255, 0.25);
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .trend-up {
            color: #4ade80;
        }

        .trend-down {
            color: #f87171;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-bottom: 20px;
        }

        .card {
            background: #3d4f5d;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, #e67e22 0%, #3498db 100%);
            opacity: 0.7;
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.4em;
            color: rgba(255, 255, 255, 0.95);
            font-weight: 600;
        }

        .card-icon {
            font-size: 1.3em;
            color: #e67e22;
            background: rgba(230, 126, 34, 0.2);
            padding: 12px;
            border-radius: 12px;
        }

        .card-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .year-filter {
            display: flex;
            gap: 5px;
            background: rgba(0, 0, 0, 0.2);
            padding: 4px;
            border-radius: 8px;
        }

        .year-btn {
            background: transparent;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.85em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .year-btn:hover {
            color: rgba(255, 255, 255, 0.9);
        }

        .year-btn.active {
            background: rgba(230, 126, 34, 0.3);
            color: #e67e22;
        }

        /* Botones de filtro para KPI de Hipotecarios */
        .kpi-filter-buttons {
            display: flex;
            gap: 6px;
            background: rgba(0, 0, 0, 0.2);
            padding: 4px;
            border-radius: 8px;
        }

        .kpi-filter-btn {
            background: transparent;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.85em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .kpi-filter-btn:hover {
            color: rgba(255, 255, 255, 0.9);
            background: rgba(255, 255, 255, 0.05);
        }

        .kpi-filter-btn.active {
            background: rgba(230, 126, 34, 0.3);
            color: #FF6A00;
            box-shadow: 0 0 10px rgba(230, 126, 34, 0.3);
        }

        .card-button {
            background: rgba(230, 126, 34, 0.2);
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            color: #e67e22;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .card-button:hover {
            background: #e67e22;
            color: white;
        }

        .chart-container {
            position: relative;
            height: 320px;
        }

        @media (max-width: 1200px) {
            .kpi-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .kpi-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .kpi-card, .card {
            animation: fadeInUp 0.6s ease-out;
        }

        .kpi-card:nth-child(1) { animation-delay: 0.1s; }
        .kpi-card:nth-child(2) { animation-delay: 0.2s; }
        .kpi-card:nth-child(3) { animation-delay: 0.3s; }
        .kpi-card:nth-child(4) { animation-delay: 0.4s; }

        /* Modal de Desglose de Leads */
        .leads-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 9999;
            animation: fadeIn 0.3s ease;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .leads-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .leads-modal-content {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            border-radius: 24px;
            padding: 0;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            overflow-x: hidden;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            animation: slideUp 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            margin: auto;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .leads-modal-header {
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
            padding: 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 3px solid rgba(255, 255, 255, 0.1);
        }

        .leads-modal-header-content {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .leads-modal-icon {
            width: 70px;
            height: 70px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .leads-modal-title-section {
            color: white;
        }

        .leads-modal-title {
            font-size: 28px;
            font-weight: 700;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .leads-modal-subtitle {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 5px;
        }

        .leads-modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .leads-modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .leads-modal-body {
            padding: 30px;
            max-height: calc(90vh - 200px);
            overflow-y: auto;
        }

        .leads-years-container {
            display: grid;
            grid-template-columns: 1fr 1px 1fr;
            gap: 30px;
            align-items: start;
        }

        .leads-year-divider {
            width: 1px;
            height: 100%;
            background: linear-gradient(to bottom, 
                transparent 0%, 
                rgba(255, 255, 255, 0.3) 20%, 
                rgba(255, 255, 255, 0.3) 80%, 
                transparent 100%);
            position: relative;
        }

        .leads-year-divider::before {
            content: 'VS';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #e67e22 0%, #3498db 100%);
            color: white;
            padding: 8px 12px;
            border-radius: 50%;
            font-size: 12px;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .leads-year-section {
            margin-bottom: 0;
        }

        .leads-year-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        .leads-year-badge {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 18px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .leads-year-badge.year-2025 {
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
        }

        .leads-year-total {
            color: white;
            font-size: 16px;
            font-weight: 600;
        }

        .leads-year-total span {
            color: #e67e22;
            font-size: 24px;
            font-weight: 700;
            margin-left: 10px;
        }

        .leads-sedes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .leads-sede-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .leads-sede-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #e67e22, #d35400);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .leads-sede-card:hover::before {
            transform: scaleX(1);
        }

        .leads-sede-card:hover {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .leads-sede-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-bottom: 12px;
            box-shadow: 0 4px 8px rgba(230, 126, 34, 0.3);
        }

        .leads-sede-name {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .leads-sede-value {
            color: white;
            font-size: 28px;
            font-weight: 700;
            font-family: 'Courier New', monospace;
        }

        .leads-sede-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            border: 1px solid rgba(46, 204, 113, 0.3);
        }

        .leads-sede-badge.new {
            background: rgba(241, 196, 15, 0.2);
            color: #f1c40f;
            border-color: rgba(241, 196, 15, 0.3);
            animation: blink 2s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .leads-modal-body::-webkit-scrollbar {
            width: 8px;
        }

        .leads-modal-body::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .leads-modal-body::-webkit-scrollbar-thumb {
            background: rgba(230, 126, 34, 0.5);
            border-radius: 10px;
        }

        .leads-modal-body::-webkit-scrollbar-thumb:hover {
            background: rgba(230, 126, 34, 0.7);
        }

        /* Responsive para el modal */
        @media (max-width: 900px) {
            .leads-years-container {
                grid-template-columns: 1fr;
                gap: 30px;
            }

            .leads-year-divider {
                display: none;
            }

            .leads-modal-content {
                max-width: 95%;
            }

            .leads-sedes-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-chart-line"></i> Dashboard Mercadeo</h1>
            <p> Comparativo 2024 vs 2025</p>
        </div>

        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-icon"><i class="fas fa-users"></i></div>
                <div class="kpi-title">Leads Totales</div>
                <div class="kpi-value" id="leads-total-value">432,765</div>
                <div class="kpi-comparison">
                    <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                        <button class="year-btn active" onclick="updateLeadsKPI('all', this)" style="flex: 1; padding: 6px 12px; font-size: 12px;">
                            Todos
                        </button>
                        <button class="year-btn" onclick="updateLeadsKPI('2024', this)" style="flex: 1; padding: 6px 12px; font-size: 12px;">
                            2024
                        </button>
                        <button class="year-btn" onclick="updateLeadsKPI('2025', this)" style="flex: 1; padding: 6px 12px; font-size: 12px;">
                            2025
                        </button>
                    </div>
                </div>
            </div>

            <div class="kpi-card">
                <div class="kpi-icon"><i class="fas fa-home"></i></div>
                <div class="kpi-title">Hipotecarios</div>
                <div class="kpi-value" id="hipotecariosKpiValue">21,784</div>
                <div class="kpi-comparison">
                    <div style="display: flex; gap: 8px; margin-bottom: 8px;">
                        <button class="year-btn active" onclick="filterHipotecariosKPI('todos', this)" style="flex: 1; padding: 6px 12px; font-size: 12px;">
                            Todos
                        </button>
                        <button class="year-btn" onclick="filterHipotecariosKPI('2024', this)" style="flex: 1; padding: 6px 12px; font-size: 12px;">
                            2024
                        </button>
                        <button class="year-btn" onclick="filterHipotecariosKPI('2025', this)" style="flex: 1; padding: 6px 12px; font-size: 12px;">
                            2025
                        </button>
                    </div>
                </div>
            </div>

            <!-- KPI de Hipotecarios estático - OCULTO
            <div class="kpi-card">
                <div class="kpi-icon"><i class="fas fa-user-check"></i></div>
                <div class="kpi-title">Hipotecarios</div>
                <div class="kpi-value">3,210</div>
                <div class="kpi-comparison">
                    <span>Dato actual vs mes anterior:</span>
                    <span class="kpi-badge trend-up">
                        <i class="fas fa-arrow-up"></i> +22.3%
                    </span>
                </div>
            </div>
            -->

            <div class="kpi-card">
                <div class="kpi-icon"><i class="fas fa-handshake"></i></div>
                <div class="kpi-title">Conversión (Leads → Hipotecarios)</div>
                <div class="kpi-value">5.02%</div>
                <div class="kpi-comparison">
                    <span>Promedio General 2024-2025</span>
                    <span class="kpi-badge trend-neutral">
                        <i class="fas fa-chart-line"></i> 21,784 hipotecarios
                    </span>
                </div>
            </div>

            <div class="kpi-card">
                <div class="kpi-icon"><i class="fas fa-dollar-sign"></i></div>
                <div class="kpi-title">CAC (Costo de Adquisición)</div>
                <div class="kpi-value">Q9,537</div>
                <div class="kpi-comparison">
                    <span>Promedio General 2024-2025</span>
                    <span class="kpi-badge trend-neutral">
                        <i class="fas fa-calculator"></i> Por caso desembolsado
                    </span>
                </div>
            </div>
        </div>

        <div class="dashboard-grid">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="card-icon"><i class="fas fa-chart-line"></i></span>
                        Leads 2024 vs 2025
                    </div>
                    <div class="card-actions">
                        <div class="kpi-filters">
                            <button class="kpi-filter-btn active" onclick="filterLeadsChart('todos')">Todos</button>
                            <button class="kpi-filter-btn" onclick="filterLeadsChart('central')">Solo Central</button>
                            <button class="kpi-filter-btn" onclick="filterLeadsChart('cooperativas')">Solo Cooperativas</button>
                            <button class="kpi-filter-btn" onclick="filterLeadsChart('jun2024')">Jun-Dic</button>
                        </div>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="lineChart"></canvas>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="card-icon"><i class="fas fa-home"></i></span>
                         Hipotecarios 2024 vs 2025
                    </div>
                    <div class="card-actions">
                        <div class="kpi-filters">
                            <button class="kpi-filter-btn active" onclick="filterHipotecariosChart('todos')">Todos</button>
                            <button class="kpi-filter-btn" onclick="filterHipotecariosChart('central')">Solo Central</button>
                            <button class="kpi-filter-btn" onclick="filterHipotecariosChart('cooperativas')">Solo Cooperativas</button>
                            <button class="kpi-filter-btn" onclick="filterHipotecariosChart('jun2024')">Jun-Dic</button>
                        </div>
                    </div>
                </div>
                <div class="chart-container">
                    <div id="barChart" style="width: 100%; height: 100%;"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="card-icon"><i class="fas fa-chart-area"></i></span>
                        Conversión Leads → Hipotecarios
                    </div>
                    <div class="card-actions">
                        <div class="kpi-filters" style="margin-right: 15px;">
                            <button class="kpi-filter-btn active" onclick="filterComboChart('todos')">Todos</button>
                            <button class="kpi-filter-btn" onclick="filterComboChart('central')">Solo Central</button>
                            <button class="kpi-filter-btn" onclick="filterComboChart('cooperativas')">Solo Cooperativas</button>
                            <button class="kpi-filter-btn" onclick="filterComboChart('jun2024')">Jun-Dic</button>
                        </div>
                    </div>
                </div>
                <div class="chart-container">
                    <div id="comboChart" style="width: 100%; height: 100%;"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <span class="card-icon"><i class="fas fa-bullseye"></i></span>
                CAC - Costo de Adquisición de Cliente
                    </div>
                    <div class="card-actions">
                        <div class="kpi-filters">
                            <button class="kpi-filter-btn active" onclick="filterCACChart('todos')">Todos</button>
                            <button class="kpi-filter-btn" onclick="filterCACChart('central')">Solo Central</button>
                            <button class="kpi-filter-btn" onclick="filterCACChart('cooperativas')">Solo Cooperativas</button>
                            <button class="kpi-filter-btn" onclick="filterCACChart('jun2024')">Jun-Dic</button>
                        </div>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="radarChart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Test inicial
        console.log('Script cargado correctamente');
        
        const colors = {
            primary2024: 'rgba(52, 152, 219, 0.85)',
            primary2025: 'rgba(230, 126, 34, 0.85)',
            border2024: 'rgba(52, 152, 219, 1)',
            border2025: 'rgba(230, 126, 34, 1)',
            gradient2024: {
                start: 'rgba(52, 152, 219, 0.9)',
                end: 'rgba(52, 152, 219, 0.1)'
            },
            gradient2025: {
                start: 'rgba(230, 126, 34, 0.9)',
                end: 'rgba(230, 126, 34, 0.1)'
            }
        };

        Chart.defaults.font.family = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
        Chart.defaults.color = '#555';

        const chartInstances = {};
        
        // Variables para rastrear filtros activos
        let currentLeadsFilter = 'todos';
        let currentHipotecariosFilter = 'todos';
        let currentConversionFilter = 'todos';
        let currentCACFilter = 'todos';

        function createGradient(ctx, color1, color2) {
            const gradient = ctx.createLinearGradient(0, 0, 0, 300);
            gradient.addColorStop(0, color1);
            gradient.addColorStop(1, color2);
            return gradient;
        }

        function filterChart(chartId, year, button) {
            const chart = chartInstances[chartId];
            if (!chart) return;

            const buttons = button.parentElement.querySelectorAll('.year-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');

            chart.data.datasets.forEach((dataset) => {
                if (year === 'all') {
                    dataset.hidden = false;
                } else if (year === '2024') {
                    dataset.hidden = !dataset.label.includes('2024');
                } else if (year === '2025') {
                    dataset.hidden = !dataset.label.includes('2025');
                }
            });

            chart.update();
        }

        // Función para actualizar KPI de Leads
        function updateLeadsKPI(year, button) {
            const total2024 = 222956; // Suma de todos los meses 2024
            const total2025 = 209809; // Suma de Ene-Sep 2025
            const totalGeneral = total2024 + total2025;

            const buttons = button.parentElement.querySelectorAll('.year-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');

            const valueElement = document.getElementById('leads-total-value');
            
            if (year === 'all') {
                valueElement.textContent = totalGeneral.toLocaleString();
            } else if (year === '2024') {
                valueElement.textContent = total2024.toLocaleString();
            } else if (year === '2025') {
                valueElement.textContent = total2025.toLocaleString();
            }
        }

        // Función para actualizar KPI de Hipotecarios
        function filterHipotecariosKPI(year, button) {
            const total2024 = 14520; // Suma de todos los meses 2024: 1502+1201+798+1007+1205+1000+1025+1609+1495+1305+1174+1199
            const total2025 = 7264;  // Suma de Ene-Sep 2025: 1396+464+980+905+740+916+557+861+445
            const totalGeneral = total2024 + total2025;

            const buttons = button.parentElement.querySelectorAll('.kpi-filter-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');

            const valueElement = document.getElementById('hipotecariosKpiValue');
            
            if (year === 'todos') {
                valueElement.textContent = totalGeneral.toLocaleString();
            } else if (year === '2024') {
                valueElement.textContent = total2024.toLocaleString();
            } else if (year === '2025') {
                valueElement.textContent = total2025.toLocaleString();
            }
        }

        // Función para filtrar KPI de Conversión
        window.filterConversionKPI = function(filter, buttonElement) {
            console.log('filterConversionKPI called with filter:', filter);
            console.log('buttonElement:', buttonElement);
            
            const totalLeads2024 = 222956;
            const totalLeads2025 = 209809;
            const totalHipo2024 = 14520;
            const totalHipo2025 = 7264;
            
            const conversion2024 = ((totalHipo2024 / totalLeads2024) * 100).toFixed(2);
            const conversion2025 = ((totalHipo2025 / totalLeads2025) * 100).toFixed(2);
            const conversionPromedio = (((totalHipo2024 + totalHipo2025) / (totalLeads2024 + totalLeads2025)) * 100).toFixed(2);
            
            console.log('conversion2024:', conversion2024);
            console.log('conversion2025:', conversion2025);
            console.log('conversionPromedio:', conversionPromedio);
            
            // Actualizar botones activos
            const buttons = buttonElement.parentElement.querySelectorAll('.kpi-filter-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            buttonElement.classList.add('active');
            
            const valueElement = document.getElementById('conversionKpiValue');
            const labelElement = document.getElementById('conversionKpiLabel');
            const badgeElement = document.getElementById('conversionKpiBadge');
            
            console.log('valueElement:', valueElement);
            console.log('labelElement:', labelElement);
            console.log('badgeElement:', badgeElement);
            
            if (filter === '2025') {
                valueElement.textContent = conversion2025 + '%';
                labelElement.textContent = 'Tasa de conversión 2025';
                const diff = (conversion2025 - conversion2024).toFixed(2);
                if (diff < 0) {
                    badgeElement.className = 'kpi-badge trend-down';
                    badgeElement.innerHTML = `<i class="fas fa-arrow-down"></i> ${diff}%`;
                } else {
                    badgeElement.className = 'kpi-badge trend-up';
                    badgeElement.innerHTML = `<i class="fas fa-arrow-up"></i> +${diff}%`;
                }
            } else if (filter === '2024') {
                console.log('Setting 2024 values...');
                valueElement.textContent = conversion2024 + '%';
                labelElement.textContent = 'Tasa de conversión 2024';
                badgeElement.className = 'kpi-badge trend-neutral';
                badgeElement.innerHTML = `<i class="fas fa-minus"></i> Año completo`;
            } else if (filter === 'promedio') {
                console.log('Setting promedio values...');
                valueElement.textContent = conversionPromedio + '%';
                labelElement.textContent = 'Promedio 2024-2025';
                badgeElement.className = 'kpi-badge trend-neutral';
                badgeElement.innerHTML = `<i class="fas fa-chart-line"></i> ${totalHipo2024 + totalHipo2025} hipotecarios`;
            }
            
            console.log('Final valueElement.textContent:', valueElement.textContent);
        };

        // 1. GRÁFICA DE LÍNEA
        const lineCtx = document.getElementById('lineChart').getContext('2d');
        const lineGradient2024 = createGradient(lineCtx, colors.gradient2024.start, colors.gradient2024.end);
        const lineGradient2025 = createGradient(lineCtx, colors.gradient2025.start, colors.gradient2025.end);

        chartInstances.lineChart = new Chart(lineCtx, {
            type: 'line',
            data: {
                labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
                datasets: [{
                    label: '2024',
                    data: [
                        16860,  // Enero - Solo Central
                        20004,  // Febrero - Solo Central
                        16650,  // Marzo - Solo Central
                        14210,  // Abril - Solo Central
                        13333,  // Mayo - Solo Central
                        6480,   // Junio - Solo Central
                        13915,  // Julio - Central (13826) + Cobán (89)
                        21184,  // Agosto - Central (20277) + Cobán (907)
                        20294,  // Septiembre - Central (19437) + Cobán (857)
                        22263,  // Octubre - Central (21634) + Cobán (629)
                        27290,  // Noviembre - Central (25191) + Cobán (2099)
                        30473   // Diciembre - Central (26907) + Cobán (3192) + Escuintla (374)
                    ],
                    borderColor: colors.border2024,
                    backgroundColor: lineGradient2024,
                    tension: 0.4,
                    fill: true,
                    pointRadius: 5,
                    pointHoverRadius: 8,
                    pointBackgroundColor: colors.border2024,
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    borderWidth: 3
                }, {
                    label: '2025',
                    data: [
                        30598,  // Enero - Central (26907) + Escuintla (2091) + Cobán (1600)
                        29009,  // Febrero - Central (23300) + Escuintla (2020) + Cobán (3689)
                        27028,  // Marzo - Central (17821) + Escuintla (4230) + Cobán (4977)
                        32078,  // Abril - Central (22584) + Escuintla (4150) + Cobán (5344)
                        21792,  // Mayo - Central (17144) + Escuintla (2320) + Cobán (2328) + Mazatenango (0)
                        22347,  // Junio - Central (11747) + Escuintla (4592) + Cobán (4694) + Mazatenango (605) + Petén (432) + 4 Caminos (277)
                        16405,  // Julio - Central (9231) + Escuintla (702) + Cobán (2791) + Mazatenango (1361) + Petén (1226) + 4 Caminos (1094)
                        20537,  // Agosto - Central (8236) + Escuintla (2483) + Cobán (3733) + Mazatenango (2550) + Petén (1877) + 4 Caminos (1658)
                        10015,  // Septiembre - Central (4466) + Escuintla (1217) + Cobán (756) + Mazatenango (1234) + Petén (1191) + 4 Caminos (1151)
                        null,   // Octubre - Sin datos
                        null,   // Noviembre - Sin datos
                        null    // Diciembre - Sin datos
                    ],
                    borderColor: colors.border2025,
                    backgroundColor: lineGradient2025,
                    tension: 0.4,
                    fill: true,
                    pointRadius: 5,
                    pointHoverRadius: 8,
                    pointBackgroundColor: colors.border2025,
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    borderWidth: 3,
                    spanGaps: true  // Para conectar la línea aunque haya valores null
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                onClick: (event, elements) => {
                    if (elements.length > 0) {
                        const index = elements[0].index;
                        openLeadsModal(index);
                    }
                },
                interaction: {
                    mode: 'index',
                    intersect: false
                },
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            font: { size: 13, weight: '600' },
                            color: 'rgba(255, 255, 255, 0.9)',
                            usePointStyle: true,
                            padding: 20
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        padding: 12,
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': ' + context.parsed.y.toLocaleString() + ' leads';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) { return value.toLocaleString(); },
                            color: 'rgba(255, 255, 255, 0.7)'
                        },
                        grid: { color: 'rgba(255, 255, 255, 0.1)' }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { color: 'rgba(255, 255, 255, 0.7)' }
                    }
                }
            }
        });

        // 2. GRÁFICA DE BARRAS - Créditos Hipotecarios (AnyChart con estilo agrupado)
        // Crear dataset con los datos mensuales
        var barDataSet = anychart.data.set([
            ['Ene', 1396, 1502],
            ['Feb', 464, 1201],
            ['Mar', 980, 798],
            ['Abr', 905, 1007],
            ['May', 740, 1205],
            ['Jun', 916, 1000],
            ['Jul', 557, 1025],
            ['Ago', 861, 1609],
            ['Sep', 445, 1495],
            ['Oct', null, 1305],
            ['Nov', null, 1174],
            ['Dic', null, 1199]
        ]);

        // Mapear datos para cada serie
        var series2025Data = barDataSet.mapAs({ x: 0, value: 1 });
        var series2024Data = barDataSet.mapAs({ x: 0, value: 2 });

        // Crear gráfica de columnas
        var barChart = anychart.column();

        // Activar animación
        barChart.animation(true);

        // Configurar fondo transparente
        barChart.background().fill('transparent');

        // Variables para series (guardar referencia global)
        var barSeries2025, barSeries2024;

        // Crear primera serie (2024) - Azul
        barSeries2024 = barChart.column(series2024Data);
        barSeries2024.name('2024');
        barSeries2024.xPointPosition(0.35);
        barSeries2024.normal().fill(colors.primary2024);
        barSeries2024.normal().stroke(colors.border2024, 2);
        barSeries2024.hovered().fill(anychart.color.lighten(colors.primary2024, 0.2));
        barSeries2024.selected().fill(anychart.color.lighten(colors.primary2024, 0.3));

        // Crear segunda serie (2025) - Naranja
        barSeries2025 = barChart.column(series2025Data);
        barSeries2025.name('2025');
        barSeries2025.xPointPosition(0.55);
        barSeries2025.normal().fill(colors.primary2025);
        barSeries2025.normal().stroke(colors.border2025, 2);
        barSeries2025.hovered().fill(anychart.color.lighten(colors.primary2025, 0.2));
        barSeries2025.selected().fill(anychart.color.lighten(colors.primary2025, 0.3));

        // Configurar padding entre grupos de barras
        barChart.barGroupsPadding(0.3);

        // Configurar eje Y
        barChart.yAxis().labels().format('{%Value}{groupsSeparator: }');
        barChart.yAxis().labels().fontColor('rgba(255, 255, 255, 0.7)');
        barChart.yAxis().labels().fontSize(11);
        barChart.yAxis().stroke('rgba(255, 255, 255, 0.1)');
        barChart.yAxis().title(false);

        // Configurar eje X
        barChart.xAxis().labels().fontColor('rgba(255, 255, 255, 0.7)');
        barChart.xAxis().labels().fontSize(11);
        barChart.xAxis().stroke('rgba(255, 255, 255, 0.1)');

        // Configurar grid
        barChart.yGrid().stroke('rgba(255, 255, 255, 0.08)');
        barChart.xGrid().enabled(false);

        // Deshabilitar título
        barChart.title(false);

        // Configurar leyenda
        barChart.legend().enabled(true);
        barChart.legend().fontSize(13);
        barChart.legend().fontColor('rgba(255, 255, 255, 0.9)');
        barChart.legend().padding([0, 0, 20, 0]);
        barChart.legend().position('top');
        barChart.legend().itemsLayout('horizontal');

        // Configurar interactividad
        barChart.interactivity().hoverMode('single');

        // Configurar tooltip mejorado con año visible
        barChart.tooltip().titleFormat('{%X}');
        barChart.tooltip().format(function() {
            return this.seriesName + ': ' + this.value.toLocaleString() + ' hipotecarios';
        });
        barChart.tooltip().fontColor('#ffffff');
        barChart.tooltip().fontSize(13);
        barChart.tooltip().background().fill('rgba(0, 0, 0, 0.9)');
        barChart.tooltip().background().stroke('rgba(255, 255, 255, 0.3)');
        barChart.tooltip().background().cornerType('round');
        barChart.tooltip().background().corners(6);

        // Agregar cursor pointer
        barChart.listen('pointsSelect', function(e) {
            var point = e.point;
            var monthIndex = point.getIndex();
            openHipotecariosModal(monthIndex);
        });

        // Configurar padding del gráfico
        barChart.padding([10, 20, 20, 20]);

        // Asignar contenedor y dibujar
        barChart.container('barChart');
        chartInstances.barChart = barChart;
        barChart.draw();

        // 3. GRÁFICA DE CONVERSIÓN - Leads → Hipotecarios (AnyChart Combo)
        // Datos del combo chart con Leads 2024 y 2025
        var comboData = anychart.data.set([
            ['Ene', 30598, 16860, 4.56, 8.91],
            ['Feb', 29009, 20004, 1.60, 6.00],
            ['Mar', 27028, 16650, 3.63, 4.79],
            ['Abr', 32078, 14210, 2.82, 7.09],
            ['May', 21792, 13333, 3.40, 9.04],
            ['Jun', 22347, 6480, 4.10, 15.43],
            ['Jul', 16405, 13915, 3.40, 7.37],
            ['Ago', 20537, 21184, 4.19, 7.60],
            ['Sep', 10015, 20294, 4.44, 7.37],
            ['Oct', null, 22263, null, 5.86],
            ['Nov', null, 27290, null, 4.30],
            ['Dic', null, 30473, null, 3.93]
        ]);

        // Mapear datos para barras Leads 2025
        var comboLeads2025Data = comboData.mapAs({ x: 0, value: 1 });
        
        // Mapear datos para barras Leads 2024
        var comboLeads2024Data = comboData.mapAs({ x: 0, value: 2 });
        
        // Mapear datos para línea Conversión 2025
        var conversion2025Data = comboData.mapAs({ x: 0, value: 3 });
        
        // Mapear datos para línea Conversión 2024
        var conversion2024Data = comboData.mapAs({ x: 0, value: 4 });

        // Crear gráfico de columnas
        var comboChart = anychart.column();
        
        // Configurar fondo transparente
        comboChart.background().fill('transparent');
        
        // Activar animación
        comboChart.animation(true);
        
        // Crear serie de barras Leads 2024 (primero)
        var columnSeries2024 = comboChart.column(comboLeads2024Data);
        columnSeries2024.name('Leads 2024');
        columnSeries2024.color('#1abc9c');
        columnSeries2024.xPointPosition(0.35);
        columnSeries2024.tooltip().format('Leads 2024: {%value}');
        
        // Crear serie de barras Leads 2025 (segundo)
        var columnSeries2025 = comboChart.column(comboLeads2025Data);
        columnSeries2025.name('Leads 2025');
        columnSeries2025.color('#3498db');
        columnSeries2025.xPointPosition(0.55);
        columnSeries2025.tooltip().format('Leads 2025: {%value}');
        
        // Configurar padding entre grupos de barras
        comboChart.barGroupsPadding(0.3);
        
        // Crear serie de línea Conversión 2024 (primero - rojo con marcadores cuadrados)
        var lineSeries2024 = comboChart.line(conversion2024Data);
        lineSeries2024.name('Conversión 2024 (%)');
        lineSeries2024.color('#e74c3c');
        lineSeries2024.stroke('3 #e74c3c');
        lineSeries2024.markers().enabled(true).size(4).type('square').fill('#e74c3c').stroke('2 #fff');
        lineSeries2024.tooltip().format('Conversión 2024: {%value}%');
        lineSeries2024.connectMissingPoints(false);
        
        // Crear serie de línea Conversión 2025 (segundo - naranja)
        var lineSeries2025 = comboChart.line(conversion2025Data);
        lineSeries2025.name('Conversión 2025 (%)');
        lineSeries2025.color('#ff8c32');
        lineSeries2025.stroke('3 #ff8c32');
        lineSeries2025.markers().enabled(true).size(5).type('circle').fill('#ff8c32').stroke('2 #fff');
        lineSeries2025.tooltip().format('Conversión 2025: {%value}%');
        lineSeries2025.connectMissingPoints(false);
        
        // Configurar eje Y izquierdo (Leads)
        var yAxis1 = comboChart.yAxis(0);
        yAxis1.title('Leads');
        yAxis1.title().fontColor('rgba(255, 255, 255, 0.9)');
        yAxis1.labels().format('{%value}');
        yAxis1.labels().fontColor('rgba(255, 255, 255, 0.7)');
        yAxis1.stroke('rgba(255, 255, 255, 0.1)');
        
        // Configurar grid
        comboChart.yGrid().stroke('rgba(255, 255, 255, 0.1)');
        comboChart.xGrid().enabled(false);
        
        // Crear y configurar eje Y derecho (Conversión %)
        var extraYScale = anychart.scales.linear();
        extraYScale.minimum(0);
        extraYScale.maximum(16);
        
        var extraYAxis = comboChart.yAxis(1);
        extraYAxis.orientation('right');
        extraYAxis.scale(extraYScale);
        extraYAxis.title('Conversión (%)');
        extraYAxis.title().fontColor('rgba(255, 140, 50, 0.9)');
        extraYAxis.labels().format('{%value}%');
        extraYAxis.labels().fontColor('rgba(255, 140, 50, 0.9)');
        extraYAxis.stroke('transparent');
        
        // Configurar eje X
        var xAxis = comboChart.xAxis();
        xAxis.labels().fontColor('rgba(255, 255, 255, 0.9)');
        xAxis.stroke('transparent');
        
        // Asignar escala del eje Y derecho a ambas líneas
        lineSeries2025.yScale(extraYScale);
        lineSeries2024.yScale(extraYScale);
        
        // Configurar leyenda
        comboChart.legend()
            .enabled(true)
            .fontSize(13)
            .padding([0, 0, 20, 0])
            .itemsLayout('horizontal')
            .align('top')
            .fontColor('rgba(255, 255, 255, 0.9)');
        
        // Configurar interactividad
        comboChart.interactivity().hoverMode('by-x');
        
        // Configurar tooltip con fondo oscuro
        comboChart.tooltip()
            .displayMode('union')
            .background().fill('rgba(0, 0, 0, 0.85)');
        comboChart.tooltip()
            .fontColor('#fff')
            .fontSize(13);
        
        // Configurar contenedor
        comboChart.container('comboChart');
        
        // Dibujar gráfico
        chartInstances.comboChart = comboChart;
        comboChart.draw();

        // Event listener para clicks en el combo chart
        comboChart.listen('pointClick', function(e) {
            const monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            const pointIndex = e.point.index;
            const xValue = e.point.get('x');
            
            // Extraer el nombre del mes del label
            let monthName = xValue;
            let monthIndex = -1;
            
            // Buscar el índice del mes
            for (let i = 0; i < monthNames.length; i++) {
                if (monthName.includes(monthNames[i].substring(0, 3))) {
                    monthIndex = i;
                    monthName = monthNames[i];
                    break;
                }
            }
            
            if (monthIndex >= 0) {
                openConversionModal(monthIndex, monthName);
            }
        });

        // FUNCIÓN PARA FILTRAR EL COMBO CHART
        window.filterComboChart = function(filter) {
            currentConversionFilter = filter; // Guardar filtro activo
            
            // Actualizar botones activos
            document.querySelectorAll('.kpi-filters button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            let newData;
            
            if (filter === 'todos') {
                // Mostrar todos los datos (todas las agencias sumadas)
                newData = anychart.data.set([
                    ['Ene', 30598, 16860, 4.56, 8.91],
                    ['Feb', 29009, 20004, 1.60, 6.00],
                    ['Mar', 27028, 16650, 3.63, 4.79],
                    ['Abr', 32078, 14210, 2.82, 7.09],
                    ['May', 21792, 13333, 3.40, 9.04],
                    ['Jun', 22347, 6480, 4.10, 15.43],
                    ['Jul', 16405, 13915, 3.40, 7.37],
                    ['Ago', 20537, 21184, 4.19, 7.60],
                    ['Sep', 10015, 20294, 4.44, 7.37],
                    ['Oct', null, 22263, null, 5.86],
                    ['Nov', null, 27290, null, 4.30],
                    ['Dic', null, 30473, null, 3.93]
                ]);
            } else if (filter === 'central') {
                // Solo Central 2025 vs Central 2024 (comparación justa)
                // Hipotecarios Central 2025: [1396, 464, 980, 905, 740, 916, 557, 861, 445]
                // Hipotecarios Central 2024: [1502, 1201, 798, 1007, 1205, 1000, 1025, 1405, 1291, 1100, 1008, 983]
                newData = anychart.data.set([
                    ['Ene', 26907, 16860, (1396/26907*100).toFixed(2), (1502/16860*100).toFixed(2)],
                    ['Feb', 23300, 20004, (464/23300*100).toFixed(2), (1201/20004*100).toFixed(2)],
                    ['Mar', 17821, 16650, (980/17821*100).toFixed(2), (798/16650*100).toFixed(2)],
                    ['Abr', 22584, 14210, (905/22584*100).toFixed(2), (1007/14210*100).toFixed(2)],
                    ['May', 17144, 13333, (740/17144*100).toFixed(2), (1205/13333*100).toFixed(2)],
                    ['Jun', 11747, 6480, (916/11747*100).toFixed(2), (1000/6480*100).toFixed(2)],
                    ['Jul', 9231, 13826, (557/9231*100).toFixed(2), (1025/13826*100).toFixed(2)],
                    ['Ago', 8236, 20277, (861/8236*100).toFixed(2), (1405/20277*100).toFixed(2)],
                    ['Sep', 4466, 19437, (445/4466*100).toFixed(2), (1291/19437*100).toFixed(2)],
                    ['Oct', null, 21634, null, (1100/21634*100).toFixed(2)],
                    ['Nov', null, 25191, null, (1008/25191*100).toFixed(2)],
                    ['Dic', null, 26907, null, (983/26907*100).toFixed(2)]
                ]);
            } else if (filter === 'cooperativas') {
                // Solo Cooperativas (Cobán, Escuintla, Mazatenango, Petén, Cuatro Caminos)
                // Desde Junio 2024 que se unió Cobán
                // 2025: Total - Central
                // 2024: Total - Central
                // Leads Cooperativas 2025
                var coopLeads2025 = [
                    30598-26907,  // Ene: 3691
                    29009-23300,  // Feb: 5709
                    27028-17821,  // Mar: 9207
                    32078-22584,  // Abr: 9494
                    21792-17144,  // May: 4648
                    22347-11747,  // Jun: 10600
                    16405-9231,   // Jul: 7174
                    20537-8236,   // Ago: 12301
                    10015-4466    // Sep: 5549
                ];
                // Leads Cooperativas 2024 (desde Junio)
                var coopLeads2024 = [
                    6480-6480,    // Jun: 0 (solo Central)
                    13915-13826,  // Jul: 89 (Cobán)
                    21184-20277,  // Ago: 907 (Cobán)
                    20294-19437,  // Sep: 857 (Cobán)
                    22263-21634,  // Oct: 629 (Cobán)
                    27290-25191,  // Nov: 2099 (Cobán)
                    30473-26907   // Dic: 3566 (Cobán+Escuintla)
                ];
                // Hipotecarios Cooperativas 2025: Total - Central
                var coopHipo2025 = [0, 0, 0, 0, 0, 0, 0, 0, 0]; // Se calculará en la data
                // Hipotecarios Cooperativas 2024
                var coopHipo2024 = [0, 0, 204, 204, 205, 166, 216]; // Desde Jul
                
                newData = anychart.data.set([
                    ['Jun-24', 10600, 0, null, null],
                    ['Jul-24', 7174, 89, null, null],
                    ['Ago-24', 12301, 907, null, (204/907*100).toFixed(2)],
                    ['Sep-24', 5549, 857, null, (204/857*100).toFixed(2)],
                    ['Oct', null, 629, null, (205/629*100).toFixed(2)],
                    ['Nov', null, 2099, null, (166/2099*100).toFixed(2)],
                    ['Dic', null, 3566, null, (216/3566*100).toFixed(2)]
                ]);
            } else if (filter === 'jun2024') {
                // Desde Junio 2024 en adelante (comparación completa desde que hay cooperativas)
                newData = anychart.data.set([
                    ['Jun', 22347, 6480, 4.10, 15.43],
                    ['Jul', 16405, 13915, 3.40, 7.37],
                    ['Ago', 20537, 21184, 4.19, 7.60],
                    ['Sep', 10015, 20294, 4.44, 7.37],
                    ['Oct', null, 22263, null, 5.86],
                    ['Nov', null, 27290, null, 4.30],
                    ['Dic', null, 30473, null, 3.93]
                ]);
            }

            // Actualizar los datos del gráfico
            var newLeads2025Data = newData.mapAs({ x: 0, value: 1 });
            var newLeads2024Data = newData.mapAs({ x: 0, value: 2 });
            var newConversion2025Data = newData.mapAs({ x: 0, value: 3 });
            var newConversion2024Data = newData.mapAs({ x: 0, value: 4 });

            // Actualizar las series
            columnSeries2025.data(newLeads2025Data);
            columnSeries2024.data(newLeads2024Data);
            lineSeries2025.data(newConversion2025Data);
            lineSeries2024.data(newConversion2024Data);

            // Redibujar el gráfico
            comboChart.draw();
        };

        // FUNCIÓN PARA FILTRAR GRÁFICA DE LEADS
        window.filterLeadsChart = function(filter) {
            currentLeadsFilter = filter; // Guardar filtro activo
            
            // Actualizar botones activos
            event.target.parentElement.querySelectorAll('.kpi-filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Datos originales
            const leads2025Full = [30598, 29009, 27028, 32078, 21792, 22347, 16405, 20537, 10015, null, null, null];
            const leads2024Full = [16860, 20004, 16650, 14210, 13333, 6480, 13915, 21184, 20294, 22263, 27290, 30473];
            
            // Datos solo Central
            const leads2025Central = [26907, 23300, 17821, 22584, 17144, 11747, 9231, 8236, 4466, null, null, null];
            const leads2024Central = [16860, 20004, 16650, 14210, 13333, 6480, 13826, 20277, 19437, 21634, 25191, 26907];
            
            // Datos solo Cooperativas
            const leads2025Coop = [3691, 5709, 9207, 9494, 4648, 10600, 7174, 12301, 5549, null, null, null];
            const leads2024Coop = [0, 0, 0, 0, 0, 0, 89, 907, 857, 629, 2099, 3566];

            let newLabels = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
            let newData2025, newData2024;

            if (filter === 'central') {
                newData2025 = leads2025Central;
                newData2024 = leads2024Central;
            } else if (filter === 'cooperativas') {
                newData2025 = leads2025Coop;
                newData2024 = leads2024Coop;
            } else if (filter === 'jun2024') {
                newLabels = ['Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
                newData2025 = [22347, 16405, 20537, 10015, null, null, null];
                newData2024 = [6480, 13915, 21184, 20294, 22263, 27290, 30473];
            } else { // todos
                newData2025 = leads2025Full;
                newData2024 = leads2024Full;
            }

            // Actualizar los datos del gráfico (datasets[0] es 2024, datasets[1] es 2025)
            chartInstances.lineChart.data.labels = newLabels;
            chartInstances.lineChart.data.datasets[0].data = newData2024;
            chartInstances.lineChart.data.datasets[1].data = newData2025;
            chartInstances.lineChart.update();
        };

        // FUNCIÓN PARA FILTRAR GRÁFICA DE HIPOTECARIOS
        window.filterHipotecariosChart = function(filter) {
            currentHipotecariosFilter = filter; // Guardar filtro activo
            
            // Actualizar botones activos
            event.target.parentElement.querySelectorAll('.kpi-filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Datos originales
            const hipo2025Full = [1396, 464, 980, 905, 740, 916, 557, 861, 445, null, null, null];
            const hipo2024Full = [1502, 1201, 798, 1007, 1205, 1000, 1025, 1609, 1495, 1305, 1174, 1199];
            
            // Datos solo Central
            const hipo2025Central = [1396, 464, 980, 905, 740, 916, 557, 861, 445, null, null, null];
            const hipo2024Central = [1502, 1201, 798, 1007, 1205, 1000, 821, 1405, 1291, 1100, 1008, 983];
            
            // Datos solo Cooperativas
            const hipo2025Coop = [0, 0, 0, 0, 0, 0, 0, 0, 0, null, null, null];
            const hipo2024Coop = [0, 0, 0, 0, 0, 0, 204, 204, 204, 205, 166, 216];

            let newLabels = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
            let newData2025, newData2024;

            if (filter === 'central') {
                newData2025 = hipo2025Central;
                newData2024 = hipo2024Central;
            } else if (filter === 'cooperativas') {
                newData2025 = hipo2025Coop;
                newData2024 = hipo2024Coop;
            } else if (filter === 'jun2024') {
                newLabels = ['Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
                newData2025 = [916, 557, 861, 445, null, null, null];
                newData2024 = [1000, 1025, 1609, 1495, 1305, 1174, 1199];
            } else { // todos
                newData2025 = hipo2025Full;
                newData2024 = hipo2024Full;
            }

            // Crear nuevo dataset con los datos filtrados (2024 primero, 2025 segundo)
            const newDataArray = newLabels.map((label, index) => [label, newData2024[index], newData2025[index]]);
            const newDataSet = anychart.data.set(newDataArray);
            
            // Mapear datos para cada serie (value: 1 es 2024, value: 2 es 2025)
            const newSeries2024Data = newDataSet.mapAs({ x: 0, value: 1 });
            const newSeries2025Data = newDataSet.mapAs({ x: 0, value: 2 });
            
            // Actualizar las series
            barSeries2024.data(newSeries2024Data);
            barSeries2025.data(newSeries2025Data);
            
            // Redibujar el gráfico
            chartInstances.barChart.draw();
        };

        // FUNCIÓN PARA FILTRAR GRÁFICA DE CAC
        window.filterCACChart = function(filter) {
            currentCACFilter = filter; // Guardar filtro activo
            
            // Actualizar botones activos
            event.target.parentElement.querySelectorAll('.kpi-filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Datos de gastos y casos desembolsados (solo Central por ahora)
            const gastosMarketing2024Full = [302000, 356839, 308378, 405634, 497225, 394521, 436676.5, 478832, 514735, 509135, 544261, 544261];
            const gastosMarketing2025Full = [517054, 616384, 472637, 442178, 421606, 544261, 533828.63, 403139.88, 403139.88, null, null, null];
            const casosDesembolsados2024Full = [60, 51, 53, 68, 60, 44, 41.5, 39, 46, 34, 35, 35];
            const casosDesembolsados2025Full = [46, 44, 57, 53, 49, 40, 60, 38, 46, null, null, null];

            let newLabels = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
            let gastos2024 = gastosMarketing2024Full;
            let gastos2025 = gastosMarketing2025Full;
            let casos2024 = casosDesembolsados2024Full;
            let casos2025 = casosDesembolsados2025Full;

            if (filter === 'jun2024') {
                newLabels = ['Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
                gastos2024 = gastosMarketing2024Full.slice(5);
                gastos2025 = gastosMarketing2025Full.slice(5);
                casos2024 = casosDesembolsados2024Full.slice(5);
                casos2025 = casosDesembolsados2025Full.slice(5);
            }
            // Para 'central' y 'cooperativas' usaremos los mismos datos por ahora
            // ya que el CAC actualmente solo tiene datos de Central

            // Calcular CAC
            const cac2024 = gastos2024.map((gasto, index) => {
                return casos2024[index] > 0 ? (gasto / casos2024[index]).toFixed(2) : null;
            });
            const cac2025 = gastos2025.map((gasto, index) => {
                return casos2025[index] > 0 ? (gasto / casos2025[index]).toFixed(2) : null;
            });

            // Actualizar los datos del gráfico
            chartInstances.radarChart.data.labels = newLabels;
            chartInstances.radarChart.data.datasets[0].data = cac2024;
            chartInstances.radarChart.data.datasets[1].data = cac2025;
            chartInstances.radarChart.update();
        };

        // 4. GRÁFICA CAC - Costo de Adquisición de Cliente (Solo Central)
        const radarCtx = document.getElementById('radarChart').getContext('2d');
        
        // Datos de gastos de marketing (solo Central)
        const gastosMarketing2024 = [302000, 356839, 308378, 405634, 497225, 394521, 436676.5, 478832, 514735, 509135, 544261, 544261];
        const gastosMarketing2025 = [517054, 616384, 472637, 442178, 421606, 544261, 533828.63, 403139.88, 403139.88, null, null, null];
        
        // Casos desembolsados (dato correcto para CAC)
        const casosDesembolsados2024 = [60, 51, 53, 68, 60, 44, 41.5, 39, 46, 34, 35, 35]; // Julio = promedio(44,39) = 41.5
        const casosDesembolsados2025 = [46, 44, 57, 53, 49, 40, 60, 38, 46, null, null, null];
        
        // Calcular CAC = Gasto Marketing / Casos Desembolsados
        const cac2024 = gastosMarketing2024.map((gasto, index) => {
            return casosDesembolsados2024[index] > 0 ? (gasto / casosDesembolsados2024[index]).toFixed(2) : null;
        });
        
        const cac2025 = gastosMarketing2025.map((gasto, index) => {
            if (gasto === null || casosDesembolsados2025[index] === null || casosDesembolsados2025[index] === 0) return null;
            return (gasto / casosDesembolsados2025[index]).toFixed(2);
        });
        
        chartInstances.radarChart = new Chart(radarCtx, {
            type: 'line',
            data: {
                labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
                datasets: [{
                    label: 'CAC 2024 (Central)',
                    data: cac2024,
                    backgroundColor: 'rgba(0, 86, 210, 0.1)',
                    borderColor: 'rgba(0, 86, 210, 1)',
                    borderWidth: 3,
                    pointBackgroundColor: 'rgba(0, 86, 210, 1)',
                    pointBorderColor: '#fff',
                    pointRadius: 5,
                    pointHoverRadius: 8,
                    pointBorderWidth: 2,
                    fill: false,
                    tension: 0.4
                }, {
                    label: 'CAC 2025 (Central)',
                    data: cac2025,
                    backgroundColor: 'rgba(255, 106, 0, 0.1)',
                    borderColor: 'rgba(255, 106, 0, 1)',
                    borderWidth: 3,
                    pointBackgroundColor: 'rgba(255, 106, 0, 1)',
                    pointBorderColor: '#fff',
                    pointRadius: 5,
                    pointHoverRadius: 8,
                    pointBorderWidth: 2,
                    fill: false,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                onClick: (event, elements) => {
                    if (elements.length > 0) {
                        const monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
                        const monthIndex = elements[0].index;
                        openCACModal(monthIndex, monthNames[monthIndex]);
                    }
                },
                interaction: {
                    mode: 'index',
                    intersect: false
                },
                plugins: {
                    legend: {
                        position: 'top',
                        labels: {
                            font: { size: 13, weight: '600' },
                            color: 'rgba(255, 255, 255, 0.9)',
                            usePointStyle: true,
                            padding: 20
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.85)',
                        padding: 15,
                        titleFont: { size: 14, weight: 'bold' },
                        bodyFont: { size: 13 },
                        callbacks: {
                            label: function(context) {
                                const label = context.dataset.label || '';
                                const value = context.parsed.y;
                                return `  ${label}: Q${Number(value).toLocaleString()}`;
                            },
                            afterLabel: function(context) {
                                const monthIndex = context.dataIndex;
                                const year = context.dataset.label.includes('2024') ? 2024 : 2025;
                                const gasto = year === 2024 ? gastosMarketing2024[monthIndex] : gastosMarketing2025[monthIndex];
                                const casos = year === 2024 ? casosDesembolsados2024[monthIndex] : casosDesembolsados2025[monthIndex];
                                if (gasto && casos) {
                                    return `  Gasto Total: Q${gasto.toLocaleString()}\n  Casos Desembolsados: ${casos}`;
                                }
                                return '';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            color: 'rgba(255, 255, 255, 0.7)',
                            font: { size: 11 },
                            callback: function(value) {
                                return 'Q' + value;
                            }
                        },
                        grid: { 
                            color: 'rgba(255, 255, 255, 0.1)',
                            drawBorder: false
                        },
                        title: {
                            display: true,
                            text: 'Costo por Cliente (Q)',
                            color: 'rgba(255, 255, 255, 0.9)',
                            font: { size: 12, weight: 'bold' }
                        }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { 
                            color: 'rgba(255, 255, 255, 0.7)',
                            font: { size: 11 }
                        }
                    }
                }
            }
        });

        // DATOS DE LEADS POR MES Y SEDE
        const leadsData = {
            months: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
            2024: [
                { central: 16860, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 20004, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 16650, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 14210, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 13333, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 6480, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 13826, coban: 89, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 }, // Cobán se une
                { central: 20277, coban: 907, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 19437, coban: 857, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 21634, coban: 629, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 25191, coban: 2099, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 26907, coban: 3192, escuintla: 374, mazatenango: 0, peten: 0, cuatroCaminos: 0 } // Escuintla se une
            ],
            2025: [
                { central: 26907, coban: 1600, escuintla: 2091, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 23300, coban: 3689, escuintla: 2020, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 17821, coban: 4977, escuintla: 4230, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 22584, coban: 5344, escuintla: 4150, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 17144, coban: 2328, escuintla: 2320, mazatenango: 0, peten: 0, cuatroCaminos: 0 }, // Mazatenango se une
                { central: 11747, coban: 4694, escuintla: 4592, mazatenango: 605, peten: 432, cuatroCaminos: 277 }, // Petén y 4 Caminos se unen
                { central: 9231, coban: 2791, escuintla: 702, mazatenango: 1361, peten: 1226, cuatroCaminos: 1094 },
                { central: 8236, coban: 3733, escuintla: 2483, mazatenango: 2550, peten: 1877, cuatroCaminos: 1658 },
                { central: 4466, coban: 756, escuintla: 1217, mazatenango: 1234, peten: 1191, cuatroCaminos: 1151 },
                null, null, null
            ]
        };

        // DATOS DE HIPOTECARIOS POR MES Y SEDE
        const hipotecariosData = {
            months: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'],
            2024: [
                { central: 1502, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 1201, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 798, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 1007, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 1205, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 1000, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 1025, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 1405, coban: 204, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 1291, coban: 204, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 1100, coban: 205, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 1008, coban: 166, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 983, coban: 216, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 }
            ],
            2025: [
                { central: 983, coban: 265, escuintla: 148, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 408, coban: 20, escuintla: 36, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 828, coban: 70, escuintla: 82, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 765, coban: 75, escuintla: 65, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 659, coban: 44, escuintla: 37, mazatenango: 0, peten: 0, cuatroCaminos: 0 },
                { central: 694, coban: 63, escuintla: 94, mazatenango: 20, peten: 30, cuatroCaminos: 15 },
                { central: 343, coban: 60, escuintla: 53, mazatenango: 58, peten: 29, cuatroCaminos: 14 },
                { central: 613, coban: 101, escuintla: 62, mazatenango: 29, peten: 30, cuatroCaminos: 26 },
                { central: 250, coban: 79, escuintla: 61, mazatenango: 24, peten: 14, cuatroCaminos: 17 },
                null, null, null
            ]
        };

        // Función para abrir el modal de Leads
        function openLeadsModal(monthIndex) {
            const modal = document.getElementById('leadsModal');
            const monthName = leadsData.months[monthIndex];
            let data2024 = leadsData[2024][monthIndex];
            let data2025 = leadsData[2025][monthIndex];
            
            // Aplicar filtro según el filtro activo
            if (currentLeadsFilter === 'central' && data2024) {
                // Solo mostrar Central
                data2024 = { central: data2024.central, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 };
            } else if (currentLeadsFilter === 'cooperativas' && data2024) {
                // Solo mostrar Cooperativas (sin Central)
                data2024 = { central: 0, coban: data2024.coban, escuintla: data2024.escuintla, mazatenango: data2024.mazatenango, peten: data2024.peten, cuatroCaminos: data2024.cuatroCaminos };
            }
            
            if (currentLeadsFilter === 'central' && data2025) {
                // Solo mostrar Central
                data2025 = { central: data2025.central, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 };
            } else if (currentLeadsFilter === 'cooperativas' && data2025) {
                // Solo mostrar Cooperativas (sin Central)
                data2025 = { central: 0, coban: data2025.coban, escuintla: data2025.escuintla, mazatenango: data2025.mazatenango, peten: data2025.peten, cuatroCaminos: data2025.cuatroCaminos };
            }
            
            // Bloquear scroll del body
            document.body.style.overflow = 'hidden';
            
            const filterText = currentLeadsFilter === 'central' ? ' (Solo Central)' : 
                              currentLeadsFilter === 'cooperativas' ? ' (Solo Cooperativas)' : 
                              currentLeadsFilter === 'jun2024' ? ' (Jun-Dic)' : '';
            document.getElementById('modalMonthTitle').textContent = monthName + filterText;
            
            let content = '<div class="leads-years-container">';
            
            // Columna 2024
            if (data2024) {
                const total2024 = Object.values(data2024).reduce((a, b) => a + b, 0);
                content += `
                    <div class="leads-year-section">
                        <div class="leads-year-header">
                            <span class="leads-year-badge">2024</span>
                            <span class="leads-year-total">Total: <span>${total2024.toLocaleString()}</span> leads</span>
                        </div>
                        <div class="leads-sedes-grid">
                `;
                
                if (data2024.central > 0) {
                    content += createSedeCard('🏢', 'Central', data2024.central);
                }
                if (data2024.coban > 0) {
                    const isNew = monthIndex === 6; // Julio es cuando se une Cobán
                    content += createSedeCard('🏔️', 'Cobán', data2024.coban, isNew);
                }
                if (data2024.escuintla > 0) {
                    const isNew = monthIndex === 11; // Diciembre es cuando se une Escuintla
                    content += createSedeCard('🌊', 'Escuintla', data2024.escuintla, isNew);
                }
                
                content += '</div></div>';
            } else {
                content += '<div class="leads-year-section"><div style="color: rgba(255,255,255,0.5); text-align: center; padding: 40px;">Sin datos para 2024</div></div>';
            }
            
            // Divisor VS
            content += '<div class="leads-year-divider"></div>';
            
            // Columna 2025
            if (data2025 && data2025 !== null) {
                const total2025 = Object.values(data2025).reduce((a, b) => a + b, 0);
                content += `
                    <div class="leads-year-section">
                        <div class="leads-year-header">
                            <span class="leads-year-badge year-2025">2025</span>
                            <span class="leads-year-total">Total: <span>${total2025.toLocaleString()}</span> leads</span>
                        </div>
                        <div class="leads-sedes-grid">
                `;
                
                if (data2025.central > 0) {
                    content += createSedeCard('🏢', 'Central', data2025.central);
                }
                if (data2025.coban > 0) {
                    content += createSedeCard('🏔️', 'Cobán', data2025.coban);
                }
                if (data2025.escuintla > 0) {
                    content += createSedeCard('🌊', 'Escuintla', data2025.escuintla);
                }
                if (data2025.mazatenango > 0) {
                    const isNew = monthIndex === 4; // Mayo es cuando se une Mazatenango
                    content += createSedeCard('🌾', 'Mazatenango', data2025.mazatenango, isNew);
                }
                if (data2025.peten > 0) {
                    const isNew = monthIndex === 5; // Junio es cuando se une Petén
                    content += createSedeCard('🌳', 'Petén', data2025.peten, isNew);
                }
                if (data2025.cuatroCaminos > 0) {
                    const isNew = monthIndex === 5; // Junio es cuando se une 4 Caminos
                    content += createSedeCard('🛣️', '4 Caminos', data2025.cuatroCaminos, isNew);
                }
                
                content += '</div></div>';
            } else {
                content += '<div class="leads-year-section"><div style="color: rgba(255,255,255,0.5); text-align: center; padding: 40px;">Sin datos para 2025</div></div>';
            }
            
            content += '</div>'; // Cierre del contenedor
            
            document.getElementById('modalLeadsContent').innerHTML = content;
            modal.classList.add('active');
        }

        // Función para crear tarjeta de sede
        function createSedeCard(icon, name, value, isNew = false) {
            const newBadge = isNew ? '<span class="leads-sede-badge new">✨ NUEVA</span>' : '';
            return `
                <div class="leads-sede-card">
                    ${newBadge}
                    <div class="leads-sede-icon">${icon}</div>
                    <div class="leads-sede-name">${name}</div>
                    <div class="leads-sede-value">${value.toLocaleString()}</div>
                </div>
            `;
        }

        // Función para abrir el modal de Hipotecarios
        function openHipotecariosModal(monthIndex) {
            const modal = document.getElementById('hipotecariosModal');
            const monthName = hipotecariosData.months[monthIndex];
            let data2024 = hipotecariosData[2024][monthIndex];
            let data2025 = hipotecariosData[2025][monthIndex];
            
            // Aplicar filtro según el filtro activo
            if (currentHipotecariosFilter === 'central' && data2024) {
                // Solo mostrar Central
                data2024 = { central: data2024.central, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 };
            } else if (currentHipotecariosFilter === 'cooperativas' && data2024) {
                // Solo mostrar Cooperativas (sin Central)
                data2024 = { central: 0, coban: data2024.coban, escuintla: data2024.escuintla, mazatenango: data2024.mazatenango, peten: data2024.peten, cuatroCaminos: data2024.cuatroCaminos };
            }
            
            if (currentHipotecariosFilter === 'central' && data2025) {
                // Solo mostrar Central
                data2025 = { central: data2025.central, coban: 0, escuintla: 0, mazatenango: 0, peten: 0, cuatroCaminos: 0 };
            } else if (currentHipotecariosFilter === 'cooperativas' && data2025) {
                // Solo mostrar Cooperativas (sin Central)
                data2025 = { central: 0, coban: data2025.coban, escuintla: data2025.escuintla, mazatenango: data2025.mazatenango, peten: data2025.peten, cuatroCaminos: data2025.cuatroCaminos };
            }
            
            // Bloquear scroll del body
            document.body.style.overflow = 'hidden';
            
            const filterText = currentHipotecariosFilter === 'central' ? ' (Solo Central)' : 
                              currentHipotecariosFilter === 'cooperativas' ? ' (Solo Cooperativas)' : 
                              currentHipotecariosFilter === 'jun2024' ? ' (Jun-Dic)' : '';
            document.getElementById('modalHipotecariosMonthTitle').textContent = monthName + filterText;
            
            let content = '<div class="leads-years-container">';
            
            // Columna 2024
            if (data2024) {
                const total2024 = Object.values(data2024).reduce((a, b) => a + b, 0);
                content += `
                    <div class="leads-year-section">
                        <div class="leads-year-header">
                            <span class="leads-year-badge">2024</span>
                            <span class="leads-year-total">Total: <span>${total2024.toLocaleString()}</span> hipotecarios</span>
                        </div>
                        <div class="leads-sedes-grid">
                `;
                
                if (data2024.central > 0) {
                    content += createSedeCard('🏢', 'Central', data2024.central);
                }
                if (data2024.coban > 0) {
                    const isNew = monthIndex === 7; // Agosto es cuando se une Cobán en hipotecarios
                    content += createSedeCard('🏔️', 'Cobán', data2024.coban, isNew);
                }
                if (data2024.escuintla > 0) {
                    content += createSedeCard('🌊', 'Escuintla', data2024.escuintla);
                }
                
                content += '</div></div>';
            } else {
                content += '<div class="leads-year-section"><div style="color: rgba(255,255,255,0.5); text-align: center; padding: 40px;">Sin datos para 2024</div></div>';
            }
            
            // Divisor VS
            content += '<div class="leads-year-divider"></div>';
            
            // Columna 2025
            if (data2025 && data2025 !== null) {
                const total2025 = Object.values(data2025).reduce((a, b) => a + b, 0);
                content += `
                    <div class="leads-year-section">
                        <div class="leads-year-header">
                            <span class="leads-year-badge year-2025">2025</span>
                            <span class="leads-year-total">Total: <span>${total2025.toLocaleString()}</span> hipotecarios</span>
                        </div>
                        <div class="leads-sedes-grid">
                `;
                
                if (data2025.central > 0) {
                    content += createSedeCard('🏢', 'Central', data2025.central);
                }
                if (data2025.coban > 0) {
                    content += createSedeCard('🏔️', 'Cobán', data2025.coban);
                }
                if (data2025.escuintla > 0) {
                    content += createSedeCard('🌊', 'Escuintla', data2025.escuintla);
                }
                if (data2025.mazatenango > 0) {
                    const isNew = monthIndex === 5; // Junio es cuando se une Mazatenango
                    content += createSedeCard('🌾', 'Mazatenango', data2025.mazatenango, isNew);
                }
                if (data2025.peten > 0) {
                    const isNew = monthIndex === 5; // Junio es cuando se une Petén
                    content += createSedeCard('🌳', 'Petén', data2025.peten, isNew);
                }
                if (data2025.cuatroCaminos > 0) {
                    const isNew = monthIndex === 5; // Junio es cuando se une 4 Caminos
                    content += createSedeCard('🛣️', '4 Caminos', data2025.cuatroCaminos, isNew);
                }
                
                content += '</div></div>';
            } else {
                content += '<div class="leads-year-section"><div style="color: rgba(255,255,255,0.5); text-align: center; padding: 40px;">Sin datos para 2025</div></div>';
            }
            
            content += '</div>'; // Cierre del contenedor
            
            document.getElementById('modalHipotecariosContent').innerHTML = content;
            modal.classList.add('active');
        }

        // Función para cerrar el modal de Leads
        function closeLeadsModal() {
            const modal = document.getElementById('leadsModal');
            if (modal) {
                modal.classList.remove('active');
                // Restaurar scroll del body
                document.body.style.overflow = '';
            }
        }

        // Función para cerrar el modal de Hipotecarios
        function closeHipotecariosModal() {
            const modal = document.getElementById('hipotecariosModal');
            if (modal) {
                modal.classList.remove('active');
                // Restaurar scroll del body
                document.body.style.overflow = '';
            }
        }

        // FUNCIÓN PARA ABRIR MODAL DE CONVERSIÓN
        function openConversionModal(monthIndex, monthName) {
            const modal = document.getElementById('conversionModal');
            const content = document.getElementById('modalConversionContent');
            
            // Datos para el comparativo
            const leadsData2024 = [16860, 20004, 16650, 14210, 13333, 6480, 13915, 21184, 20294, 22263, 27290, 30473];
            const leadsData2025 = [30598, 29009, 27028, 32078, 21792, 22347, 16405, 20537, 10015];
            const hipoData2024 = [1502, 1201, 798, 1007, 1205, 1000, 1025, 1609, 1495, 1305, 1174, 1199];
            const hipoData2025 = [1396, 464, 980, 905, 740, 916, 557, 861, 445];
            
            const meses = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            
            const leads2024 = leadsData2024[monthIndex];
            const leads2025 = leadsData2025[monthIndex];
            const hipo2024 = hipoData2024[monthIndex];
            const hipo2025 = hipoData2025[monthIndex];
            
            const conv2024 = leads2024 ? ((hipo2024 / leads2024) * 100).toFixed(2) : 'N/A';
            const conv2025 = leads2025 ? ((hipo2025 / leads2025) * 100).toFixed(2) : 'N/A';
            const diferencia = (leads2025 && leads2024) ? (conv2025 - conv2024).toFixed(2) : 'N/A';
            
            document.getElementById('modalConversionTitle').textContent = `Conversión - ${monthName}`;
            
            let diferenciaHTML = '';
            if (diferencia !== 'N/A') {
                const isPositive = diferencia > 0;
                const icon = isPositive ? '📈' : '📉';
                const color = isPositive ? '#27ae60' : '#e74c3c';
                const sign = isPositive ? '+' : '';
                diferenciaHTML = `
                    <div style="padding: 20px; background: linear-gradient(135deg, ${color}22, ${color}11); border-radius: 12px; text-align: center; margin-bottom: 25px; border-left: 4px solid ${color};">
                        <div style="font-size: 36px; margin-bottom: 10px;">${icon}</div>
                        <div style="font-size: 14px; color: rgba(255,255,255,0.7); margin-bottom: 8px;">Cambio vs 2024</div>
                        <div style="font-size: 32px; font-weight: 700; color: ${color};">${sign}${diferencia}%</div>
                    </div>
                `;
            }
            
            content.innerHTML = `
                ${diferenciaHTML}
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 25px;">
                    <div style="padding: 25px; background: linear-gradient(135deg, #0056D244, #0056D222); border-radius: 12px; border-left: 4px solid #0056D2;">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                            <div style="font-size: 36px;">📅</div>
                            <div>
                                <div style="font-size: 14px; color: rgba(255,255,255,0.7);">Año 2024</div>
                                <div style="font-size: 24px; font-weight: 700; color: #0056D2;">${conv2024}%</div>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
                            <div>
                                <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 5px;">Leads</div>
                                <div style="font-size: 18px; font-weight: 600;">${leads2024 ? leads2024.toLocaleString() : 'N/A'}</div>
                            </div>
                            <div>
                                <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 5px;">Hipotecarios</div>
                                <div style="font-size: 18px; font-weight: 600;">${hipo2024 ? hipo2024.toLocaleString() : 'N/A'}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="padding: 25px; background: linear-gradient(135deg, #FF6A0044, #FF6A0022); border-radius: 12px; border-left: 4px solid #FF6A00;">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                            <div style="font-size: 36px;">📅</div>
                            <div>
                                <div style="font-size: 14px; color: rgba(255,255,255,0.7);">Año 2025</div>
                                <div style="font-size: 24px; font-weight: 700; color: #FF6A00;">${conv2025}%</div>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
                            <div>
                                <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 5px;">Leads</div>
                                <div style="font-size: 18px; font-weight: 600;">${leads2025 ? leads2025.toLocaleString() : 'N/A'}</div>
                            </div>
                            <div>
                                <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 5px;">Hipotecarios</div>
                                <div style="font-size: 18px; font-weight: 600;">${hipo2025 ? hipo2025.toLocaleString() : 'N/A'}</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="padding: 20px; background: rgba(255,255,255,0.05); border-radius: 12px;">
                    <div style="font-size: 14px; color: rgba(255,255,255,0.7); margin-bottom: 10px;">💡 Análisis</div>
                    <div style="font-size: 13px; line-height: 1.6;">
                        ${leads2025 && leads2024 ? 
                            `De cada 100 leads en ${monthName} 2025, ${Math.round(conv2025)} se convierten en hipotecarios, comparado con ${Math.round(conv2024)} de cada 100 en 2024.` 
                            : 'Datos no disponibles para comparación completa.'}
                    </div>
                </div>
            `;
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeConversionModal() {
            const modal = document.getElementById('conversionModal');
            if (modal) {
                modal.classList.remove('active');
                document.body.style.overflow = '';
            }
        }

        // FUNCIÓN PARA ABRIR MODAL DE CAC
        function openCACModal(monthIndex, monthName) {
            const modal = document.getElementById('cacModal');
            const content = document.getElementById('modalCACContent');
            
            // Datos de CAC
            const gastosData2024 = [302000, 356839, 308378, 405634, 497225, 394521, 436676.5, 478832, 514735, 509135, 544261, 544261];
            const gastosData2025 = [517054, 616384, 472637, 442178, 421606, 544261, 533828.63, 403139.88, 403139.88];
            const casosData2024 = [60, 51, 53, 68, 60, 44, 41.5, 39, 46, 34, 35, 35];
            const casosData2025 = [46, 44, 57, 53, 49, 40, 60, 38, 46];
            
            const gasto2024 = gastosData2024[monthIndex];
            const gasto2025 = gastosData2025[monthIndex];
            const casos2024 = casosData2024[monthIndex];
            const casos2025 = casosData2025[monthIndex];
            
            const cac2024 = gasto2024 && casos2024 ? (gasto2024 / casos2024).toFixed(2) : 'N/A';
            const cac2025 = gasto2025 && casos2025 ? (gasto2025 / casos2025).toFixed(2) : 'N/A';
            const diferencia = (cac2025 !== 'N/A' && cac2024 !== 'N/A') ? (cac2025 - cac2024).toFixed(2) : 'N/A';
            const porcentajeDif = (cac2025 !== 'N/A' && cac2024 !== 'N/A') ? (((cac2025 - cac2024) / cac2024) * 100).toFixed(1) : 'N/A';
            
            document.getElementById('modalCACTitle').textContent = `CAC - ${monthName}`;
            
            let diferenciaHTML = '';
            if (diferencia !== 'N/A') {
                const isNegative = diferencia < 0; // Negativo es bueno para CAC (menor costo)
                const icon = isNegative ? '💚' : '⚠️';
                const color = isNegative ? '#27ae60' : '#e74c3c';
                const sign = diferencia > 0 ? '+' : '';
                const mensaje = isNegative ? 'Mejora en eficiencia' : 'Aumento en costo';
                diferenciaHTML = `
                    <div style="padding: 20px; background: linear-gradient(135deg, ${color}22, ${color}11); border-radius: 12px; text-align: center; margin-bottom: 25px; border-left: 4px solid ${color};">
                        <div style="font-size: 36px; margin-bottom: 10px;">${icon}</div>
                        <div style="font-size: 14px; color: rgba(255,255,255,0.7); margin-bottom: 8px;">${mensaje}</div>
                        <div style="font-size: 28px; font-weight: 700; color: ${color};">${sign}Q${Number(diferencia).toLocaleString()}</div>
                        <div style="font-size: 14px; color: rgba(255,255,255,0.6); margin-top: 5px;">(${sign}${porcentajeDif}% vs 2024)</div>
                    </div>
                `;
            }
            
            content.innerHTML = `
                ${diferenciaHTML}
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 25px;">
                    <div style="padding: 25px; background: linear-gradient(135deg, #0056D244, #0056D222); border-radius: 12px; border-left: 4px solid #0056D2;">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                            <div style="font-size: 36px;">💵</div>
                            <div>
                                <div style="font-size: 14px; color: rgba(255,255,255,0.7);">CAC 2024</div>
                                <div style="font-size: 24px; font-weight: 700; color: #0056D2;">Q${cac2024 !== 'N/A' ? Number(cac2024).toLocaleString() : 'N/A'}</div>
                            </div>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 10px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-size: 12px; color: rgba(255,255,255,0.6);">Gasto Total:</span>
                                <span style="font-size: 14px; font-weight: 600;">Q${gasto2024 ? gasto2024.toLocaleString() : 'N/A'}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-size: 12px; color: rgba(255,255,255,0.6);">Casos Desembolsados:</span>
                                <span style="font-size: 14px; font-weight: 600;">${casos2024 ? casos2024 : 'N/A'}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="padding: 25px; background: linear-gradient(135deg, #FF6A0044, #FF6A0022); border-radius: 12px; border-left: 4px solid #FF6A00;">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                            <div style="font-size: 36px;">💵</div>
                            <div>
                                <div style="font-size: 14px; color: rgba(255,255,255,0.7);">CAC 2025</div>
                                <div style="font-size: 24px; font-weight: 700; color: #FF6A00;">Q${cac2025 !== 'N/A' ? Number(cac2025).toLocaleString() : 'N/A'}</div>
                            </div>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 10px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-size: 12px; color: rgba(255,255,255,0.6);">Gasto Total:</span>
                                <span style="font-size: 14px; font-weight: 600;">Q${gasto2025 ? gasto2025.toLocaleString() : 'N/A'}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="font-size: 12px; color: rgba(255,255,255,0.6);">Casos Desembolsados:</span>
                                <span style="font-size: 14px; font-weight: 600;">${casos2025 ? casos2025 : 'N/A'}</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="padding: 20px; background: rgba(255,255,255,0.05); border-radius: 12px;">
                    <div style="font-size: 14px; color: rgba(255,255,255,0.7); margin-bottom: 10px;">💡 Interpretación</div>
                    <div style="font-size: 13px; line-height: 1.6;">
                        ${cac2025 !== 'N/A' && cac2024 !== 'N/A' ? 
                            `En ${monthName} 2025 se invirtió Q${Number(cac2025).toLocaleString()} por cada caso desembolsado, ${diferencia < 0 ? 'reduciendo' : 'aumentando'} el costo en Q${Math.abs(diferencia).toLocaleString()} respecto a 2024.`
                            : 'Datos no disponibles para comparación completa.'}
                    </div>
                </div>
            `;
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeCACModal() {
            const modal = document.getElementById('cacModal');
            if (modal) {
                modal.classList.remove('active');
                document.body.style.overflow = '';
            }
        }

        // Inicializar event listeners del modal después de que el DOM esté cargado
        window.addEventListener('DOMContentLoaded', function() {
            const leadsModal = document.getElementById('leadsModal');
            
            if (leadsModal) {
                // Cerrar modal al hacer clic fuera
                leadsModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeLeadsModal();
                    }
                });
            }

            // Event listeners para modal de hipotecarios
            const hipotecariosModal = document.getElementById('hipotecariosModal');
            
            if (hipotecariosModal) {
                // Cerrar modal al hacer clic fuera
                hipotecariosModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeHipotecariosModal();
                    }
                });
            }

            // Event listeners para modal de conversión
            const conversionModal = document.getElementById('conversionModal');
            
            if (conversionModal) {
                // Cerrar modal al hacer clic fuera
                conversionModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeConversionModal();
                    }
                });
            }

            // Event listeners para modal de CAC
            const cacModal = document.getElementById('cacModal');
            
            if (cacModal) {
                // Cerrar modal al hacer clic fuera
                cacModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeCACModal();
                    }
                });
            }

            // Cerrar modales con tecla ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeLeadsModal();
                    closeHipotecariosModal();
                    closeConversionModal();
                    closeCACModal();
                }
            });
        });
    </script>

    <!-- Modal de Desglose de Leads -->
    <div id="leadsModal" class="leads-modal">
        <div class="leads-modal-content">
            <div class="leads-modal-header">
                <div class="leads-modal-header-content">
                    <div class="leads-modal-icon">
                        📊
                    </div>
                    <div class="leads-modal-title-section">
                        <h2 class="leads-modal-title" id="modalMonthTitle">Enero 2024</h2>
                        <p class="leads-modal-subtitle">Desglose detallado por sede</p>
                    </div>
                </div>
                <button class="leads-modal-close" onclick="closeLeadsModal()">
                    ×
                </button>
            </div>
            <div class="leads-modal-body" id="modalLeadsContent">
                <!-- El contenido se generará dinámicamente -->
            </div>
        </div>
    </div>

    <!-- Modal de Desglose de Hipotecarios -->
    <div id="hipotecariosModal" class="leads-modal">
        <div class="leads-modal-content">
            <div class="leads-modal-header">
                <div class="leads-modal-header-content">
                    <div class="leads-modal-icon">
                        🏠
                    </div>
                    <div class="leads-modal-title-section">
                        <h2 class="leads-modal-title" id="modalHipotecariosMonthTitle">Enero 2024</h2>
                        <p class="leads-modal-subtitle">Desglose de hipotecarios por sede</p>
                    </div>
                </div>
                <button class="leads-modal-close" onclick="closeHipotecariosModal()">
                    ×
                </button>
            </div>
            <div class="leads-modal-body" id="modalHipotecariosContent">
                <!-- El contenido se generará dinámicamente -->
            </div>
        </div>
    </div>

    <!-- Modal de Conversión Comparativa -->
    <div id="conversionModal" class="leads-modal">
        <div class="leads-modal-content">
            <div class="leads-modal-header">
                <div class="leads-modal-header-content">
                    <div class="leads-modal-icon">
                        📊
                    </div>
                    <div class="leads-modal-title-section">
                        <h2 class="leads-modal-title" id="modalConversionTitle">Comparativo de Conversión</h2>
                        <p class="leads-modal-subtitle">Análisis mensual de conversión</p>
                    </div>
                </div>
                <button class="leads-modal-close" onclick="closeConversionModal()">
                    ×
                </button>
            </div>
            <div class="leads-modal-body" id="modalConversionContent">
                <!-- El contenido se generará dinámicamente -->
            </div>
        </div>
    </div>

    <!-- Modal de CAC Comparativo -->
    <div id="cacModal" class="leads-modal">
        <div class="leads-modal-content">
            <div class="leads-modal-header">
                <div class="leads-modal-header-content">
                    <div class="leads-modal-icon">
                        💰
                    </div>
                    <div class="leads-modal-title-section">
                        <h2 class="leads-modal-title" id="modalCACTitle">Comparativo de CAC</h2>
                        <p class="leads-modal-subtitle">Costo de Adquisición por Cliente</p>
                    </div>
                </div>
                <button class="leads-modal-close" onclick="closeCACModal()">
                    ×
                </button>
            </div>
            <div class="leads-modal-body" id="modalCACContent">
                <!-- El contenido se generará dinámicamente -->
            </div>
        </div>
    </div>
</body>
</html>
